{
  "openapi": "3.0.0",
  "info": {
    "title": "Auth Service",
    "description": "<h2>Third party call service</h2>\n<ul>\n  <li>User gọi resource-service đính kèm basic authen trong header </li>\n  <li>\n    Traefik sau khi đã được config sẽ forward request vào trong service này để check quyền\n    <ul>\n      <li>\n        Nếu user không có quyền sẽ trả về ngay lập tức response với statusCode=403 và ko gọi vào resource-service\n      </li>\n      <li>\n        Nếu thành công request sẽ đưỢc forward vào trong resource-service với header được thêm vào là X-App-Id đánh dấu id của app và X-Quota có định dạng là {\"quota\": {}}\n      </li>\n    </ul>\n  </li>\n</ul>\n",
    "version": "1.0",
    "contact": {}
  },
  "tags": [],
  "servers": [
    {
      "url": "/",
      "description": "Authentication Service"
    }
  ],
  "components": {
    "schemas": {
      "PackagePermission": {
        "type": "object",
        "properties": {
          "idApiGroups": {
            "description": "list of api group id",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "CreateAppDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "name of app"
          },
          "idPackage": {
            "type": "string",
            "description": "id of corresponding package"
          },
          "quota": {
            "type": "object",
            "description": "quota passing for downstream service"
          },
          "permission": {
            "description": "permission",
            "allOf": [
              {
                "$ref": "#/components/schemas/PackagePermission"
              }
            ]
          }
        },
        "required": [
          "name",
          "idPackage"
        ]
      },
      "UpdateAppDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "name of app, use this field as username in basic authentication"
          }
        },
        "required": [
          "name"
        ]
      },
      "UserInvitationDto": {
        "type": "object",
        "properties": {
          "idUser": {
            "type": "string",
            "description": "id of user to invite to app"
          },
          "permission": {
            "description": "permission",
            "allOf": [
              {
                "$ref": "#/components/schemas/PackagePermission"
              }
            ]
          }
        },
        "required": [
          "idUser"
        ]
      },
      "CreatePackageDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "name of package",
            "examples": [
              "Free",
              "Premium"
            ]
          },
          "quota": {
            "type": "object",
            "description": "quota passing for downstream service"
          },
          "permission": {
            "description": "permission",
            "allOf": [
              {
                "$ref": "#/components/schemas/PackagePermission"
              }
            ]
          }
        },
        "required": [
          "name"
        ]
      },
      "ApiDto": {
        "type": "object",
        "properties": {
          "mode": {
            "type": "string",
            "description": "http method",
            "enum": [
              "READ",
              "FULL"
            ]
          },
          "path": {
            "type": "string",
            "description": "path"
          }
        },
        "required": [
          "mode",
          "path"
        ]
      },
      "CreateApiGroupDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "apis": {
            "description": "list of for api",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ApiDto"
            }
          }
        },
        "required": [
          "name"
        ]
      },
      "UpdateApiGroupDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          }
        },
        "required": [
          "name"
        ]
      },
      "AddApisDto": {
        "type": "object",
        "properties": {
          "api": {
            "$ref": "#/components/schemas/ApiDto"
          }
        },
        "required": [
          "api"
        ]
      },
      "UpdateApisDto": {
        "type": "object",
        "properties": {
          "old": {
            "$ref": "#/components/schemas/ApiDto"
          },
          "new": {
            "$ref": "#/components/schemas/ApiDto"
          }
        },
        "required": [
          "old",
          "new"
        ]
      },
      "DeleteApisDto": {
        "type": "object",
        "properties": {
          "api": {
            "$ref": "#/components/schemas/ApiDto"
          }
        },
        "required": [
          "api"
        ]
      },
      "LoginDto": {
        "type": "object",
        "properties": {
          "username": {
            "type": "string",
            "description": "username",
            "minLength": 5
          },
          "password": {
            "type": "string",
            "description": "password"
          }
        },
        "required": [
          "username",
          "password"
        ]
      },
      "RegisterDto": {
        "type": "object",
        "properties": {
          "username": {
            "type": "string",
            "description": "username",
            "minLength": 5
          },
          "password": {
            "type": "string",
            "description": "password"
          }
        },
        "required": [
          "username",
          "password"
        ]
      },
      "CreateUserDto": {
        "type": "object",
        "properties": {
          "username": {
            "type": "string",
            "description": "username",
            "minLength": 5
          },
          "password": {
            "type": "string",
            "description": "password"
          }
        },
        "required": [
          "username",
          "password"
        ]
      },
      "UpdateUserDto": {
        "type": "object",
        "properties": {
          "password": {
            "type": "string",
            "description": "password",
            "minLength": 8
          }
        },
        "required": [
          "password"
        ]
      },
      "CreateGroupDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "permission": {
            "description": "permission",
            "allOf": [
              {
                "$ref": "#/components/schemas/PackagePermission"
              }
            ]
          }
        },
        "required": [
          "name"
        ]
      },
      "UpdateGroupDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "permission": {
            "description": "permission",
            "allOf": [
              {
                "$ref": "#/components/schemas/PackagePermission"
              }
            ]
          }
        }
      }
    }
  },
  "paths": {
    "/auth-service/v1/health": {
      "get": {
        "operationId": "HealthController_getHealth",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "health"
        ]
      }
    },
    "/auth-service/v1/apps": {
      "get": {
        "operationId": "AppsController_getAll",
        "parameters": [
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "schema": {
              "default": 10,
              "type": "number"
            }
          },
          {
            "name": "offset",
            "required": false,
            "in": "query",
            "schema": {
              "default": 0,
              "type": "number"
            }
          },
          {
            "name": "sort",
            "required": false,
            "in": "query",
            "schema": {
              "default": 1,
              "type": "number"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "apps"
        ]
      },
      "post": {
        "operationId": "AppsController_create",
        "parameters": [
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAppDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "apps"
        ]
      }
    },
    "/auth-service/v1/apps/{id}": {
      "get": {
        "operationId": "AppsController_get",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "apps"
        ]
      },
      "patch": {
        "operationId": "AppsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAppDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "apps"
        ]
      }
    },
    "/auth-service/v1/apps/permissions/api": {
      "get": {
        "operationId": "AppsController_checkApiPathPermission",
        "parameters": [
          {
            "name": "path",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "method",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-App-Id",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "apps"
        ]
      }
    },
    "/auth-service/v1/apps/{id}/user/invitation": {
      "post": {
        "operationId": "AppsController_inviteUser",
        "parameters": [
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserInvitationDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "apps"
        ]
      },
      "patch": {
        "operationId": "AppsController_updateInviation",
        "parameters": [
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserInvitationDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "apps"
        ]
      }
    },
    "/auth-service/v1/apps/{id}/tokens": {
      "post": {
        "operationId": "AppsController_createToken",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "apps"
        ]
      }
    },
    "/auth-service/v1/apps/{id}/tokens/{username}": {
      "delete": {
        "operationId": "AppsController_deleteToken",
        "parameters": [
          {
            "name": "username",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": ""
          }
        },
        "tags": [
          "apps"
        ]
      }
    },
    "/auth-service/v1/packages": {
      "get": {
        "operationId": "PackagesController_getAll",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "packages"
        ]
      },
      "post": {
        "operationId": "PackagesController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePackageDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "packages"
        ]
      }
    },
    "/auth-service/v1/packages/{id}": {
      "get": {
        "operationId": "PackagesController_get",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "packages"
        ]
      }
    },
    "/auth-service/v1/api-groups": {
      "get": {
        "operationId": "ApiGroupsController_getAll",
        "parameters": [
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "schema": {
              "default": 10,
              "type": "number"
            }
          },
          {
            "name": "offset",
            "required": false,
            "in": "query",
            "schema": {
              "default": 0,
              "type": "number"
            }
          },
          {
            "name": "sort",
            "required": false,
            "in": "query",
            "schema": {
              "default": 1,
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "api-groups"
        ]
      },
      "post": {
        "operationId": "ApiGroupsController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateApiGroupDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "api-groups"
        ]
      }
    },
    "/auth-service/v1/api-groups/{id}": {
      "get": {
        "operationId": "ApiGroupsController_get",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "api-groups"
        ]
      },
      "patch": {
        "operationId": "ApiGroupsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateApiGroupDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "api-groups"
        ]
      }
    },
    "/auth-service/v1/api-groups/{id}/apis": {
      "post": {
        "operationId": "ApiGroupsController_addApi",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddApisDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "api-groups"
        ]
      },
      "patch": {
        "operationId": "ApiGroupsController_updateApi",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateApisDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "api-groups"
        ]
      },
      "delete": {
        "operationId": "ApiGroupsController_deleteApi",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeleteApisDto"
              }
            }
          }
        },
        "responses": {
          "204": {
            "description": ""
          }
        },
        "tags": [
          "api-groups"
        ]
      }
    },
    "/auth-service/v1/users": {
      "get": {
        "operationId": "UsersController_getAll",
        "parameters": [
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "schema": {
              "default": 10,
              "type": "number"
            }
          },
          {
            "name": "offset",
            "required": false,
            "in": "query",
            "schema": {
              "default": 0,
              "type": "number"
            }
          },
          {
            "name": "sort",
            "required": false,
            "in": "query",
            "schema": {
              "default": 1,
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "users"
        ]
      },
      "post": {
        "operationId": "UsersController_create",
        "parameters": [
          {
            "name": "",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUserDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "users"
        ]
      },
      "patch": {
        "operationId": "UsersController_update",
        "parameters": [
          {
            "name": "",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateUserDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "users"
        ]
      }
    },
    "/auth-service/v1/users/search": {
      "get": {
        "operationId": "UsersController_search",
        "parameters": [
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "schema": {
              "default": 10,
              "type": "number"
            }
          },
          {
            "name": "offset",
            "required": false,
            "in": "query",
            "schema": {
              "default": 0,
              "type": "number"
            }
          },
          {
            "name": "sort",
            "required": false,
            "in": "query",
            "schema": {
              "default": 1,
              "type": "number"
            }
          },
          {
            "name": "text",
            "required": true,
            "in": "query",
            "description": "search text",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "fields",
            "required": true,
            "in": "query",
            "description": "field to search, splitted by comma",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "users"
        ]
      }
    },
    "/auth-service/v1/users/login": {
      "post": {
        "operationId": "UsersController_login",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "users"
        ]
      }
    },
    "/auth-service/v1/users/register": {
      "post": {
        "operationId": "UsersController_register",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "users"
        ]
      }
    },
    "/auth-service/v1/groups": {
      "get": {
        "operationId": "GroupsController_getAll",
        "parameters": [
          {
            "name": "X-App-Id",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "schema": {
              "default": 10,
              "type": "number"
            }
          },
          {
            "name": "offset",
            "required": false,
            "in": "query",
            "schema": {
              "default": 0,
              "type": "number"
            }
          },
          {
            "name": "sort",
            "required": false,
            "in": "query",
            "schema": {
              "default": 1,
              "type": "number"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "groups"
        ]
      },
      "post": {
        "operationId": "GroupsController_create",
        "parameters": [
          {
            "name": "X-App-Id",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateGroupDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "groups"
        ]
      }
    },
    "/auth-service/v1/groups/{id}": {
      "get": {
        "operationId": "GroupsController_getById",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-App-Id",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "groups"
        ]
      },
      "put": {
        "operationId": "GroupsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-App-Id",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateGroupDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "groups"
        ]
      },
      "delete": {
        "operationId": "GroupsController_delete",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-App-Id",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": ""
          }
        },
        "tags": [
          "groups"
        ]
      }
    },
    "/auth-service/v1/groups/{idGroup}/users/{idUser}": {
      "post": {
        "operationId": "GroupsController_addUser",
        "parameters": [
          {
            "name": "idGroup",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "X-App-Id",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "idUser",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "groups"
        ]
      }
    }
  }
}