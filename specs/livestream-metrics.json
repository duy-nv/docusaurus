{"openapi":"3.0.0","info":{"title":"Interactive Livestream Engagement Service","description":"<table>\n  <thead>\n    <tr>\n      <th>Sự kiện</th>\n      <th>Metadata</th>\n      <th>Mô tả</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>poll</td>\n      <td>\n        <code>\n          {\n            selectedOption: string // Option mà người dùng lựa chọn\n          }\n        </code>\n      </td>\n      <td>Sử dụng để khi người dùng lựa chon trong overlay có loại là poll</td>\n    </tr>\n    <tr>\n      <td>trivia</td>\n      <td>\n        <code>\n          {\n            selectedOptions: string[] // Các options mà người dùng lựa chọn\n          }\n        </code>\n      </td>\n      <td>Sử dụng để khi người dùng lựa chon trong overlay có loại là trivia</td>\n    </tr>\n    <tr>\n      <td>lower third</td>\n      <td>\n        <code>\n          {\n            userClick: boolean \n          }\n        </code>\n      </td>\n      <td>Sử dụng để khi người dùng lựa chon trong overlay có loại là lower third</td>\n    </tr>\n    <tr>\n      <td>_overlay_show_successfully</td>\n      <td><code>null</code></td>\n      <td>Sử dụng khi overlay hiển thị thành công</td>\n    </tr>\n    <tr>\n      <td>_overlay_show_failed</td>\n      <td><code>null</code></td>\n      <td>Sử dụng khi overlay không thể hiển thị thành công trên máy người dùng</td>\n    </tr>\n    <tr>\n      <td>_overlay_show_lasted_for</td>\n      <td>\n        <code>\n          {\n            duration: number // lượng thời gian mà overlays hiển thị\n          }\n        </code>\n      </td>\n      <td>Sử dụng khi overlay kết thúc, thông báo lượng thời gian mà overlay đã hiển thị trên máy người dùng</td>\n    </tr>\n    <tr>\n      <td>_overlay_closed</td>\n      <td><code>null</code></td>\n      <td>Sử dụng khi ngườI dùng đóng overlay</td>\n    </tr>\n    <tr>\n      <td>_overlay_timeout</td>\n      <td><code>null</code></td>\n      <td>Sử dụng overlay bị timeout khi hiển thị</td>\n    </tr>\n    <tr>\n      <td>_overlay_interacted</td>\n      <td><code>null</code></td>\n      <td>Sử dụng khi người dùng bắt đầu tương tác với overlay</td>\n    </tr>\n    <tr>\n      <td>_user_visited</td>\n      <td><code>null</code></td>\n      <td>Sử dụng khi người dùng bắt đầu tương tác với livestream</td>\n    </tr>\n  </tbody>\n</table>\n\n## Metrics\n\n### Poll\n\n```ts\n{\n  poll: {\n    [selectOption]: {\n      curCount: number // số lượng người dùng lựa chọn đáp án tại thời điểm hiện tại\n      buckets: number[] // số lượng người dùng lựa chọn đáp án tại thời trước đó\n      times: number[] // thời gian tương ứng ghi vào buckets\n    }\n  }\n}\n```\n\n### Trivia\n\n```ts\n{\n  trivia: {\n    userIds: string[] // danh sách id của người dùng đã trả lời câu hỏi\n    answerStats: {\n      [selectOption]: string[] // danh sách id ngườI dùng lựa chọn đáp án này\n    } []\n    bestPlayer: {\n      numCorrectAnswers: number // số lượng câu trả lời đúng\n      time: number // thời gian hoàn thành\n      userId: string // id của người dùng\n    }\n    topPlayers: {\n      numCorrectAnswers: number // số lượng câu trả lời đúng\n      time: number // thời gian hoàn thành\n      userId: string // id của người dùng\n    } []\n  }\n}\n```\n\n### Lower third\n```ts\n{\n  lower_third: {\n    count: number // số lượng lần người dùng click vào\n  }\n}\n```\n\n### Internal Metrics\n```ts\n{\n  _overlay_show_successfully: {\n    curCount: number // số lượng hiển thị thành công tại thời điểm hiện tại\n    buckets: number[] // số lượng hiển thị thành công tại thời trước đó\n    times: number[] // thời gian tương ứng ghi vào buckets    \n  }\n  _overlay_show_failed: {\n    curCount: number // số lượng hiển thị thất bại tại thời điểm hiện tại\n    buckets: number[] // số lượng hiển thị thất bại tại thời trước đó\n    times: number[] // thời gian tương ứng ghi vào buckets    \n  }\n  _overlay_closed: {\n    curCount: number // số lượng người dùng đóng overlay tại thời điểm hiện tại\n    buckets: number[] // số lượng người dùng đóng overlay tại thời trước đó\n    times: number[] // thời gian tương ứng ghi vào buckets    \n  }\n  _overlay_timeout: {\n    curCount: number // số lượng overlay bị timeout tại thời điểm hiện tại\n    buckets: number[] // số lượng overlay bị timeout tại thời trước đó\n    times: number[] // thời gian tương ứng ghi vào buckets    \n  }\n  _overlay_interacted: {\n    curCount: number // số lượng overlay được tương tác tại thời điểm hiện tại\n    buckets: number[] // số lượng overlay được tương tác tại thời trước đó\n    times: number[] // thời gian tương ứng ghi vào buckets    \n  }\n  _overlay_show_lasted_for: {\n    [action]: {\n      min: number // tối thiểu\n      max: number //  tối đa\n      avg: number // trung bình\n      count: number // số lượng\n    }\n  }\n}\n```\n\n### Users Retention\n```ts\n{\n  _user_visited: {\n    [dateTimestamp]: {\n      userIds: string[] // danh sách id người dùng trong ngày\n      retentionRateIn7days: {\n        numNewUsers: number // số lượng người dùng mới\n        numRetainUsers: number // số lưỢng người dùng vẫn ở lại\n      }[]\n    }\n  }\n}\n```","version":"1.0","contact":{}},"tags":[],"servers":[{"url":""}],"components":{"schemas":{"Response":{"type":"object","properties":{"statusCode":{"type":"number","description":"code status"},"message":{"description":"message","type":"array","items":{"type":"string"}},"data":{"type":"object"}},"required":["statusCode","message","data"]},"CreateEventDto":{"type":"object","properties":{"userId":{"type":"string","description":"id of user that create the interaction events"},"overlayId":{"type":"string","description":"id of overlay that user uses to create the interaction events"},"userInput":{"type":"string","description":"metadata of event for processing","example":"{\"selectedOption\":\"A\"}"},"action":{"type":"string","description":"id of overlay that user uses to create the interaction events","enum":["poll","trivia","lower_third","prediction","prediction_answer","_overlay_received","_overlay_show_successfully","_overlay_show_failed","_overlay_show_lasted_for","_overlay_closed","_overlay_timeout","_overlay_interacted","_user_visited"]}},"required":["userId","overlayId","userInput","action"]}}},"paths":{"/ilp-engagement-service/v1/health":{"get":{"operationId":"HealthController_getHealth","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Response"}}}}},"tags":["health"]}},"/ilp-engagement-service/v1/events":{"post":{"operationId":"EventsController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateEventDto"}}}},"responses":{"201":{"description":""}},"tags":["events"]}},"/ilp-engagement-service/v1/events/overlays/{idOverlay}/start-time/reset":{"put":{"operationId":"EventsController_resetStartTime","parameters":[{"name":"idOverlay","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["events"]}},"/ilp-engagement-service/v1/stats/internal-metrics/{overlayId}":{"get":{"operationId":"StatsController_getInternalMetrics","parameters":[{"name":"overlayId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["stats"]}},"/ilp-engagement-service/v1/stats/external-metrics/{overlayId}":{"get":{"operationId":"StatsController_getExternalMetrics","parameters":[{"name":"overlayId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["stats"]}},"/ilp-engagement-service/v1/stats/user-retention/{livestreamId}":{"get":{"operationId":"StatsController_getUserRetentionMetrics","parameters":[{"name":"livestreamId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["stats"]}},"/ilp-engagement-service/v1/stats/history/{ofParam}/{id}":{"get":{"operationId":"StatsController_getOverlaysOf","parameters":[{"name":"ofParam","required":true,"in":"path","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}},{"name":"limit","required":false,"in":"query","description":"limit","schema":{"default":1,"type":"number"}},{"name":"offset","required":false,"in":"query","description":"offset","schema":{"default":0,"type":"number"}},{"name":"sort","required":false,"in":"query","description":"offset","schema":{"default":1,"type":"number"}},{"name":"withMetrics","required":false,"in":"query","description":"attach metrics or not","schema":{"default":false,"type":"boolean"}}],"responses":{"200":{"description":""}},"tags":["stats"]}},"/ilp-engagement-service/v1/results/overlays/{id}":{"get":{"operationId":"ResultsController_getOverlayResult","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["results"]}}}}